<!DOCTYPE html>
<html>
    <head>
    	<meta charset="utf-8">       
        <title>Pike - rpg example</title>
         <style>
        
	        html, body {
				overflow: hidden;
				width: 100%;
				height: 100%;
				margin:0;
				padding:0;
				border: 0;
			}
	        		
			#pike-stage{
				background:#eeeeee;
				margin:0 auto;
				border:5px solid #333;			
			}
			
			.xstats {
				position: absolute;
				top: 0;
				right: 0;
			 }			
		</style>
				
    <script src="../../../closure-library/closure/goog/base.js"></script>
    <script src="../../source/deps.js"></script>
	<script>
		goog.require('pike.assets.ImageManager');		
		goog.require('pike.core.Viewport');
		goog.require('pike.core.GameWorld');
		goog.require('pike.core.EntityManager');
		goog.require('pike.core.RenderManager');		
		goog.require('pike.layers.Layer');		
		goog.require('pike.core.Timer');
		goog.require('pike.core.Entity');
		goog.require('pike.components.Sprite');		
	</script>
	<script>
		window.onload = function(){
			
			var imageManager = new pike.assets.ImageManager();
			imageManager.load({
				"bg"		:"../img/bg.png",
				"entities"	:"../img/entities.png",
				"fg"		:"../img/fg.png"	
			}, onImageLoaded);
			
			function onImageLoaded(){				
				
				var timer = new pike.core.Timer();
				var viewport = new pike.core.Viewport();
				var gameWorld = new pike.core.GameWorld();
																		
				var renderManager = new pike.core.RenderManager();
				renderManager.handler.listen(viewport, pike.events.ChangeSize.EVENT_TYPE, goog.bind(renderManager.onViewportChangeSize, renderManager));
				renderManager.handler.listen(viewport, pike.events.ChangePosition.EVENT_TYPE, goog.bind(renderManager.onViewportChangePosition, renderManager));
				renderManager.handler.listen(gameWorld, pike.events.ChangeSize.EVENT_TYPE, goog.bind(renderManager.onGameWorldChangeSize, renderManager));
				renderManager.handler.listen(timer, pike.events.Render.EVENT_TYPE, goog.bind(renderManager.onRender, renderManager));
				
				renderManager.addLayer( new pike.layers.Layer("entities") );
				
				viewport.setSize(600, 400);
				//timer.start();
				
				var ent = new pike.core.Entity( pike.components.Sprite )
				ent.setLayer("sss");				
			}				
		}
	</script>
	
    </head>
    <body>                      
        <h1 align="center">Pike - rpg example</h1>
               
        <div id="pike-stage"></div>                     
                              
        <script src="../../libs/xstats/xstats.js"></script>
        <script>
        	var stats = new xStats;
			document.body.appendChild(stats.element);	
        </script>            
    </body>
</html>
