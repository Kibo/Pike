<!doctype html>
<html>
<head>
<title>Test Case</title>
</head>
<body>
<script src="../../closure-library/closure/goog/base.js"></script>
<script src="js/deps.js"></script>
<script>
	goog.require('goog.testing.ContinuationTestCase');	
	goog.require('goog.testing.jsunit');	
</script>
<script>		
	goog.require('pike.layers.CollisionLayer');	
	goog.require('pike.core.Entity');
	goog.require('goog.events.EventTarget');
	goog.require('goog.events');
	goog.require('pike.events.ChangePosition');	 
</script>
<script>
var layer
function setUpPage(){}
function setUp(){
	layer = new pike.layers.CollisionLayer("entity", 10, [1,0,0,0,0,1,1,1,0,1,
                                                          1,0,0,0,0,1,1,1,0,1,
                                                          0,1,0,1,0,1,1,1,0,0 ]);
	layer.setGameWorldSize(100,30); //10x3
}

function testGetValue(){				
	assertEquals( 1, layer.getValue(0,0) );	
	assertEquals( 1, layer.getValue(0,9) );
	
	assertEquals( 1, layer.getValue(1,0) );
	assertEquals( 1, layer.getValue(1,5) );
	assertEquals( 1, layer.getValue(1,9) );
	
	assertEquals( 0, layer.getValue(2,0) );
	assertEquals( 1, layer.getValue(2,1) );
	assertEquals( 0, layer.getValue(2,9) );
	
	//out of bounds
	assertEquals( 0, layer.getValue(-100, -100) );
	assertEquals( 0, layer.getValue(100, 100) );
};

function testPx2Value(){
	assertEquals( 1, layer.px2Value_(0, 0));
	assertEquals( 0, layer.px2Value_(10, 0));
	assertEquals( 1, layer.px2Value_(90, 0));
	
	assertEquals( 1, layer.px2Value_(0, 10));
	assertEquals( 0, layer.px2Value_(0, 20));
	assertEquals( 0, layer.px2Value_(90, 20));
	
	assertEquals( 1, layer.px2Value_(5, 5));
	
	assertEquals( 1, layer.px2Value_(5, 15));
	
	assertEquals( 1, layer.px2Value_(9, 0));
}


function testIsInCollision(){
	
	 var entity = new pike.core.Entity();
	 entity.w = 20;
	 entity.h = 20;
	 
	 entity.x = 0;
	 entity.y = 0;	 
	 assertEquals( true, layer.isInCollision( entity ));
	 
	 entity.x = 10;
	 entity.y = 0;	 
	 assertEquals( false, layer.isInCollision( entity ));
	 
	 entity.x = 80;
	 entity.y = 10;	 
	 assertEquals( true, layer.isInCollision( entity ));	
	 
	 entity.x = 30;
	 entity.y = 0;	 
	 assertEquals( false, layer.isInCollision( entity ));
	 
	 
	 entity.w = 10;
	 entity.h = 10;
	 
	 entity.x = 0;
	 entity.y = 0;	 
	 assertEquals( true, layer.isInCollision( entity ));
	 
	 entity.x = 5;
	 entity.y = 5;	 
	 assertEquals( true, layer.isInCollision( entity ));
	 
	 entity.x = 9;
	 entity.y = 9;	 
	 assertEquals( true, layer.isInCollision( entity ));
	 
	 entity.x = 10;
	 entity.y = 10;	 
	 assertEquals( false, layer.isInCollision( entity ));
	 
	 	 
	 entity.w = 40;
	 entity.h = 20;
	 
	 entity.x = 10;
	 entity.y = 0;	 
	 assertEquals( false, layer.isInCollision( entity ));	 
};

function tearDown(){}
</script>
</body>
</html>