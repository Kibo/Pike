<!doctype html>
<html>
<head>
<title>Test Case</title>
</head>
<body>
<script src="../../closure-library/closure/goog/base.js"></script>
<script src="../source/deps.js"></script>
<script>
	goog.require('goog.testing.ContinuationTestCase');	
	goog.require('goog.testing.jsunit');	
</script>
<script>
	goog.require('pike.core.RenderManager');
	goog.require('pike.layers.Layer');	
	goog.require('pike.events.ChangeSize');	
	goog.require('pike.events.ChangePosition');	
	
	goog.require('pike.core.Viewport');	
	goog.require('pike.core.GameWorld');
	goog.require('pike.core.Timer');
		
</script>
<script>
function setUpPage(){}
function setUp(){}

var testGetHandler = function(){
	var rm = new pike.core.RenderManager(new pike.core.Viewport, new pike.core.GameWorld, new pike.core.Timer);	
	assertTrue( rm.handler instanceof goog.events.EventHandler);
};

var testAddLayer = function(){
	var rm = new pike.core.RenderManager(new pike.core.Viewport, new pike.core.GameWorld, new pike.core.Timer);	
	var layer = new pike.layers.Layer("Entities");
	rm.addLayer( layer );
	assertEquals( layer, rm.layers_[0]);
};

var testGetLayer = function(){
	var rm = new pike.core.RenderManager(new pike.core.Viewport, new pike.core.GameWorld, new pike.core.Timer);	
	var layer = new pike.layers.Layer("Entities");
	rm.addLayer( layer );
	assertEquals( layer,  rm.getLayer("Entities") );
};

var testViewportChangePosition = function(){
	var rm = new pike.core.RenderManager(new pike.core.Viewport, new pike.core.GameWorld, new pike.core.Timer);	
	var layer = new pike.layers.Layer("Entities");
	rm.addLayer( layer );
			
	var e = new pike.events.ChangePosition( 0, 0, 10, 20, null)
	rm.onViewportChangePosition(e)
	
	assertTrue( layer.getScreen().canvas.width == 0);
	assertTrue( layer.getScreen().canvas.height == 0);
	assertTrue( layer.getScreen().isDirty);
		
	assertTrue( layer.getOffScreen().canvas.width == 0);
	assertTrue( layer.getOffScreen().canvas.height == 0);
	assertFalse( layer.getOffScreen().isDirty);
	
};

var testViewportChangeSize = function(){
	var rm = new pike.core.RenderManager(new pike.core.Viewport, new pike.core.GameWorld, new pike.core.Timer);		
	var layer = new pike.layers.Layer("Entities");
	rm.addLayer( layer );
			
	var e = new pike.events.ChangeSize( 0, 0, 100, 10, null)
	rm.onViewportChangeSize(e)
	
	assertTrue( layer.getScreen().canvas.width == 100);
	assertTrue( layer.getScreen().canvas.height == 10);
	assertTrue( layer.getScreen().isDirty);
		
	assertTrue( layer.getOffScreen().canvas.width == 0);
	assertTrue( layer.getOffScreen().canvas.height == 0);
	assertFalse( layer.getOffScreen().isDirty);
};

var testGameWorldChangeSize = function(){
	var rm = new pike.core.RenderManager(new pike.core.Viewport, new pike.core.GameWorld, new pike.core.Timer);		
	var layer = new pike.layers.Layer("Entities");
	rm.addLayer( layer );
		
	var e = new pike.events.ChangeSize( 0, 0, 1000, 100, null)
	rm.onGameWorldChangeSize(e)
	
	assertTrue( layer.getScreen().canvas.width == 0);
	assertTrue( layer.getScreen().canvas.height == 0);
	assertFalse( layer.getScreen().isDirty);
	
	assertTrue( layer.getOffScreen().canvas.width == 1000);
	assertTrue( layer.getOffScreen().canvas.height == 100);
	assertTrue( layer.getOffScreen().isDirty);
};








function tearDown(){}
</script>
</body>
</html>
